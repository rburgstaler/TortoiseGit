From c1ef64f326d77a3cb3fe9d2b571f7e819a03abe0 Mon Sep 17 00:00:00 2001
From: Patrick Steinhardt <ps@pks.im>
Date: Tue, 10 Nov 2015 15:53:09 +0100
Subject: [PATCH 1002/1024] tests: add merge-conflict branch for testrepo

Add a new branch that causes a merge conflict to `testrepo` so
that we are able to test merging in worktrees.
---
 tests/iterator/workdir.c                                  |   3 ++-
 tests/refs/list.c                                         |   4 ++--
 .../objects/9b/1719f5cf069568785080a0bbabbe7c377e22ae     | Bin 0 -> 24 bytes
 .../objects/a3/8d028f71eaa590febb7d716b1ca32350cf70da     | Bin 0 -> 155 bytes
 .../objects/ad/edac69457183c8265c8a9614c1c4fed31d1ff3     | Bin 0 -> 119 bytes
 .../resources/testrepo/.gitted/refs/heads/merge-conflict  | Bin 0 -> 41 bytes
 tests/revwalk/basic.c                                     |   2 +-
 7 files changed, 5 insertions(+), 4 deletions(-)
 create mode 100644 tests/resources/testrepo/.gitted/objects/9b/1719f5cf069568785080a0bbabbe7c377e22ae
 create mode 100644 tests/resources/testrepo/.gitted/objects/a3/8d028f71eaa590febb7d716b1ca32350cf70da
 create mode 100644 tests/resources/testrepo/.gitted/objects/ad/edac69457183c8265c8a9614c1c4fed31d1ff3
 create mode 100644 tests/resources/testrepo/.gitted/refs/heads/merge-conflict

diff --git a/tests/iterator/workdir.c b/tests/iterator/workdir.c
index 165cca5..f33fd98 100644
--- a/tests/iterator/workdir.c
+++ b/tests/iterator/workdir.c
@@ -613,6 +613,7 @@ void test_iterator_workdir__filesystem2(void)
 		"heads/ident",
 		"heads/long-file-name",
 		"heads/master",
+		"heads/merge-conflict",
 		"heads/packed-test",
 		"heads/subtrees",
 		"heads/test",
@@ -629,7 +630,7 @@ void test_iterator_workdir__filesystem2(void)
 
 	cl_git_pass(git_iterator_for_filesystem(
 		&i, "testrepo/.git/refs", NULL));
-	expect_iterator_items(i, 14, expect_base, 14, expect_base);
+	expect_iterator_items(i, 15, expect_base, 15, expect_base);
 	git_iterator_free(i);
 }
 
diff --git a/tests/refs/list.c b/tests/refs/list.c
index b4101ba..f7ca3f7 100644
--- a/tests/refs/list.c
+++ b/tests/refs/list.c
@@ -36,7 +36,7 @@ void test_refs_list__all(void)
 	/* We have exactly 12 refs in total if we include the packed ones:
 	 * there is a reference that exists both in the packfile and as
 	 * loose, but we only list it once */
-	cl_assert_equal_i((int)ref_list.count, 16);
+	cl_assert_equal_i((int)ref_list.count, 17);
 
 	git_strarray_free(&ref_list);
 }
@@ -51,7 +51,7 @@ void test_refs_list__do_not_retrieve_references_which_name_end_with_a_lock_exten
 		"144344043ba4d4a405da03de3844aa829ae8be0e\n");
 
 	cl_git_pass(git_reference_list(&ref_list, g_repo));
-	cl_assert_equal_i((int)ref_list.count, 16);
+	cl_assert_equal_i((int)ref_list.count, 17);
 
 	git_strarray_free(&ref_list);
 }
diff --git a/tests/resources/testrepo/.gitted/objects/9b/1719f5cf069568785080a0bbabbe7c377e22ae b/tests/resources/testrepo/.gitted/objects/9b/1719f5cf069568785080a0bbabbe7c377e22ae
new file mode 100644
index 0000000000000000000000000000000000000000..13e3f581a83ab9bb85f981c1ced8c88be9a191f4
GIT binary patch
literal 24
gcmb<m^geacKWIaW$GP*~r%(FmJ!E3g-Od^c0E<-$YybcN

literal 0
HcmV?d00001

diff --git a/tests/resources/testrepo/.gitted/objects/a3/8d028f71eaa590febb7d716b1ca32350cf70da b/tests/resources/testrepo/.gitted/objects/a3/8d028f71eaa590febb7d716b1ca32350cf70da
new file mode 100644
index 0000000000000000000000000000000000000000..4df22ec176bc0cd1a50b6ce5b8f81a45ba6e165d
GIT binary patch
literal 155
zcmV;M0A&Ao0hP{C3c@f908qboivA1IG-<nmh({1SL6)XibaT{rf5jVkfCo>W%hJpR
z$UEz*j*AwSG*QejqKqL$8F@-T0zy>_LV;Rw*tqLzZdQy5S+V9R&S55uIEyH944I2(
zs<|ejf!}s}c6VXxP44b$+SVKQV(z%T&fEQUXv@g~QHGQzAKc!9_k;X?rvJ+?UF)NX
J4IlRaMI(p8ODF&U

literal 0
HcmV?d00001

diff --git a/tests/resources/testrepo/.gitted/objects/ad/edac69457183c8265c8a9614c1c4fed31d1ff3 b/tests/resources/testrepo/.gitted/objects/ad/edac69457183c8265c8a9614c1c4fed31d1ff3
new file mode 100644
index 0000000000000000000000000000000000000000..c054fc0c4845646a59fa291938a981d056e7e3f3
GIT binary patch
literal 119
zcmV--0Eqv10V^p=O;s>7G-5C`FfcPQQ3!H%bn$g%SfOmF@NI2De~WFK%%kl}eMcVO
zI|fyeRFs&PoDrXvnUktlQc=P%TU_$%dA6w;6#)$kcCX%7V_v7U4yrUSwH&NuxoF$L
Z`!ANu<m}H8n(yEf=JeliF92^DFAb1IHG=>E

literal 0
HcmV?d00001

diff --git a/tests/resources/testrepo/.gitted/refs/heads/merge-conflict b/tests/resources/testrepo/.gitted/refs/heads/merge-conflict
new file mode 100644
index 0000000000000000000000000000000000000000..3e24a24e06317336f3d0cff372a6ffa1443bfd3e
GIT binary patch
literal 41
vcmV~$Nf7`r2n4Wy)o=`j%2_V|5}H7xNn)J`utz(Y-p)6<prS^#PL1;c^yv$E

literal 0
HcmV?d00001

diff --git a/tests/revwalk/basic.c b/tests/revwalk/basic.c
index 5ed7da4..e01dc92 100644
--- a/tests/revwalk/basic.c
+++ b/tests/revwalk/basic.c
@@ -177,7 +177,7 @@ void test_revwalk_basic__glob_heads_with_invalid(void)
 		/* walking */;
 
 	/* git log --branches --oneline | wc -l => 16 */
-	cl_assert_equal_i(18, i);
+	cl_assert_equal_i(19, i);
 }
 
 void test_revwalk_basic__push_head(void)
-- 
2.9.0.windows.1

